<?xml version="1.0" encoding="utf-8"?>
<UserControl x:Class="YAOCr.Views.ConversationView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:local="using:YAOCr.Views"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
			 xmlns:controls="using:YAOCr.Controls"
			 xmlns:models="using:YAOCr.Core.Models"
			 xmlns:selectors="using:YAOCr.Themes.Selectors"
			 mc:Ignorable="d">


	<Grid ColumnSpacing="36">
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="*" />
			<ColumnDefinition Width="3*" />
		</Grid.ColumnDefinitions>

		<!-- Conversations panel (left side) -->
		<Border Grid.Column="0">
			<Grid Style="{ThemeResource ThemedGridStyle}">
				<Grid.RowDefinitions>
					<RowDefinition Height="Auto" />
					<RowDefinition Height="*" />
					<RowDefinition Height="Auto" />
				</Grid.RowDefinitions>

				<Button x:Name="btnNewConversation"
						Grid.Row="0"
						Style="{ThemeResource ThemedButtonStyle}"
						HorizontalAlignment="Stretch"
						Padding="16"
						PointerEntered="btn_PointerEntered"
						PointerExited="btn_PointerExited"
						Command="{Binding CreateConversationCommand}">
					<StackPanel Orientation="Horizontal"
								HorizontalAlignment="Center">
						<TextBlock Text="New Conversation"
								   TextAlignment="Center"
								   Margin="0,0,16,0" />
						<FontIcon Glyph="&#xE8BD;" />
					</StackPanel>
				</Button>

				<ListView x:Name="lstConversations"
						  Grid.Row="1"
						  ItemsSource="{Binding Conversations}"
						  SelectedItem="{Binding SelectedConversation, Mode=TwoWay}"
						  SelectionMode="Single"
						  Style="{ThemeResource ThemedListViewStyle}">
					<ListView.ItemTemplate>
						<DataTemplate>
							<Border>
								<controls:ConversationItem Conversation="{Binding Mode=TwoWay}"
														   SaveCommand="{Binding ElementName=lstConversations, Path=DataContext.SaveConversationCommand}" />

							</Border>
						</DataTemplate>
					</ListView.ItemTemplate>
				</ListView>

				<Button x:Name="btnSettings"
						Grid.Row="2"
						Style="{ThemeResource ThemedButtonStyle}"
						HorizontalAlignment="Stretch"
						Padding="16"
						PointerEntered="btn_PointerEntered"
						PointerExited="btn_PointerExited"
						Command="{Binding OpenSettingsDialogCommand}">
					<StackPanel Orientation="Horizontal"
								HorizontalAlignment="Center">
						<TextBlock Text="Settings"
								   TextAlignment="Center"
								   Margin="0,0,16,0" />
						<FontIcon Glyph="&#xE713;" />
					</StackPanel>
				</Button>
			</Grid>
		</Border>

		<!-- Messages panel (right side) -->
		<Border Grid.Column="1">
			<Grid>
				<Grid>
					<Grid.RowDefinitions>
						<RowDefinition Height="*" />
						<RowDefinition Height="Auto" />
					</Grid.RowDefinitions>

					<ListView x:Name="lstMessages"
							  Grid.Row="0"
							  ItemsSource="{Binding ElementName=lstConversations, Path=SelectedItem.Messages}">
						<ListView.ItemContainerStyleSelector>
							<selectors:MessageStyleSelector />
						</ListView.ItemContainerStyleSelector>
						<ListView.ItemTemplate>
							<DataTemplate>
								<controls:ConversationMessageItem Message="{Binding}" />
							</DataTemplate>
						</ListView.ItemTemplate>
					</ListView>

					<controls:Prompt Grid.Row="0"
									 SendCommand="{Binding SendMessageCommand}"
									 PlaceholderText="Type your message"
									 HorizontalAlignment="Stretch"
									 HorizontalContentAlignment="Stretch"
									 VerticalAlignment="Bottom" />

				</Grid>

				<ProgressRing IsActive="{Binding IsLoading}" />
			</Grid>
		</Border>
	</Grid>
</UserControl>
