<?xml version="1.0" encoding="utf-8"?>
<UserControl x:Class="YAOCr.Views.SettingsView"
			 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
			 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
			 xmlns:local="using:YAOCr.Views"
			 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
			 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
			 xmlns:controls="using:CommunityToolkit.WinUI.Controls"
			 xmlns:ui="using:CommunityToolkit.WinUI"
			 xmlns:plugins="using:YAOCr.Plugins"
			 mc:Ignorable="d"
			 Visibility="Collapsed">

	<Grid Style="{ThemeResource ThemedDialogMainGridStyle}">
		<Grid Style="{ThemeResource ThemedSettingsCotentGridStyle}">
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto" />
				<RowDefinition />
			</Grid.RowDefinitions>

			<!-- HEADER -->
			<Grid Grid.Row="0"
				  Style="{ThemeResource ThemedSettingsGridHeaderStyle}">
				<TextBlock Text="Settings"
						   Style="{ThemeResource ThemedSettingsTextBlockHeaderStyle}" />

				<Button x:Name="btnClose"
						HorizontalAlignment="Right"
						VerticalAlignment="Top"
						Click="btnClose_Click"
						PointerEntered="btn_PointerEntered"
						PointerExited="btn_PointerExited"
						Style="{ThemeResource ThemedCloseDialogButtonStyle}"
						Command="{Binding SaveSettingsCommand}">
					<FontIcon Glyph="&#xE711;" />
				</Button>
			</Grid>

			<!-- SETTINGS -->
			<ScrollViewer Grid.Row="1">
				<StackPanel Padding="16">
					<TextBlock Text="General"
							   Margin="0, 16, 0, 12"
							   Style="{StaticResource SubtitleTextBlockStyle}" />

					<!-- Qdrant settings -->
					<controls:SettingsCard Header="Qdrant Server Url"
										   Description="Set the address of Qdrant server"
										   HeaderIcon="{ui:FontIcon Glyph=&#xF22C;}">
						<TextBox Text="{Binding Settings.QdrantServerAddress, Mode=TwoWay}"
								 Style="{ThemeResource ThemedTextBoxStyle}"
								 Width="320"
								 MaxWidth="320" />
					</controls:SettingsCard>

					<!-- LLM Backend settings -->
					<controls:SettingsExpander Header="LLM Backend"
											   Description="Configure the LLM backend options"
											   HeaderIcon="{ui:FontIcon Glyph=&#xE99A;}">
						<controls:SettingsExpander.Items>
							<controls:SettingsCard Header="Completion address">
								<TextBox Text="{Binding Settings.CompletionAddress, Mode=TwoWay}"
										 Style="{ThemeResource ThemedTextBoxStyle}"
										 Width="320"
										 MaxWidth="320" />
							</controls:SettingsCard>
							<controls:SettingsCard Header="Chat address">
								<TextBox Text="{Binding Settings.ChatAddress, Mode=TwoWay}"
										 Style="{ThemeResource ThemedTextBoxStyle}"
										 Width="320"
										 MaxWidth="320" />
							</controls:SettingsCard>
							<controls:SettingsCard Header="Embeddings address">
								<TextBox Text="{Binding Settings.EmbeddingsAddress, Mode=TwoWay}"
										 Style="{ThemeResource ThemedTextBoxStyle}"
										 Width="320"
										 MaxWidth="320" />
							</controls:SettingsCard>
							<controls:SettingsCard Header="Model name">
								<TextBox Text="{Binding Settings.ModelName, Mode=TwoWay}"
										 Style="{ThemeResource ThemedTextBoxStyle}"
										 Width="320"
										 MaxWidth="320" />
							</controls:SettingsCard>
						</controls:SettingsExpander.Items>
					</controls:SettingsExpander>

					<!-- Plugins list -->
					<controls:SettingsExpander Header="Plugins"
											   Description="List of available plugins"
											   ItemsSource="{Binding Plugins}"
											   HeaderIcon="{ui:FontIcon Glyph=&#xEA86;}">
						<controls:SettingsExpander.ItemTemplate>
							<DataTemplate x:DataType="plugins:IPlugin">
								<controls:SettingsCard Header="{Binding Name}"
													   Description="{Binding Description}" />
							</DataTemplate>
						</controls:SettingsExpander.ItemTemplate>

					</controls:SettingsExpander>

					<!-- Appereance settings -->
					<TextBlock Text="Appereance"
							   Margin="0, 16, 0, 12"
							   Style="{StaticResource SubtitleTextBlockStyle}" />
					<controls:SettingsCard  Header="Application theme"
											Description="Choose the application theme">
						<controls:SettingsCard.HeaderIcon>
							<FontIcon Glyph="&#xE790;" />
						</controls:SettingsCard.HeaderIcon>

						<ComboBox x:Name="cmbTheme"
								  SelectedItem="{Binding Settings.Theme, Mode=TwoWay}"
								  Style="{ThemeResource ThemedComboBoxStyle}"
								  ItemContainerStyle="{ThemeResource ThemedComboBoxItemContainerStyle}"
								  SelectionChanged="cmbTheme_SelectionChanged">
							<x:String>Light</x:String>
							<x:String>Dark</x:String>
						</ComboBox>
					</controls:SettingsCard>
				</StackPanel>
			</ScrollViewer>

		</Grid>

	</Grid>
</UserControl>
